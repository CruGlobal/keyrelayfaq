<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Key/Relay Merge FAQ</title>
<link rel="stylesheet" href="https://stackedit.io/res-min/themes/base.css" />
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body><div class="container"><h2 id="keyrelay-merge-faq">Key/Relay Merge FAQ</h2>

<ul>
<li><p><a href="#what-is-the-merge-logic">What is the merge logic?</a></p></li>
<li><p><a href="#which-users-will-be-affected">Which users will be affected?</a></p></li>
<li><p><a href="#what-can-i-do-ahead-of-time-to-prepare">What can I do ahead of time to prepare?</a></p></li>
<li><p><a href="#are-there-constraints-on-us-about-which-email-is-allowed-as-a-relay-username">Are there constraints on us about which email is allowed as a Relay username?</a></p></li>
<li><p><a href="#are-we-merging-into-the-key-or-into-relay-or-is-the-end-result-something-different">Are we merging into the Key or into Relay? Or is the end result something different?</a></p></li>
<li><p><a href="#either-way-will-i-still-have-admin-access-afterwards">Either way will I still have admin access afterwards?</a></p></li>
<li><p><a href="#do-we-need-to-do-anything-with-our-sites-weve-set-up-using-various-cas-plugins-to-authenticate-against-the-key">Do we need to do anything with our sites we’ve set up using various CAS plugins to authenticate against the Key?</a></p></li>
<li><p><a href="#is-there-anything-youll-need-us-to-do">Is there anything you’ll need us to do?</a></p></li>
<li><p><a href="#what-does-that-mean-in-terms-of-single-sign-on-will-things-still-be-separate-then-if-say-i-were-logged-into-the-us-staff-web-and-then-opened-gma-in-another-tab-or-would-gma-think-i-was-already-logged-in-with-my-relay-account">What does that mean in terms of single sign on?</a></p></li>
<li><p><a href="#if-so-will-there-be-a-way-for-users-to-merge-key-accounts-and-relay-accounts-that-have-different-use-names">Will there be a way for users to merge key accounts and relay accounts that have different use names?</a></p></li>
<li><p><a href="#if-the-two-products-are-going-to-use-a-single-database-that-is-joining-all-the-records-together-does-that-mean-every-account-in-the-key-without-a-corresponding-relay-record-will-become-a-relay-account-and-vice-versa">If the two products are going to use a single database that is joining all the records together - does that mean every account in the key without a corresponding relay record will become a relay account and vice versa?</a></p></li>
<li><p><a href="#what-happens-with-the-guids-in-the-cases-where-the-user-name-is-the-same-in-both-systems-how-will-it-pick-which-one-to-keep">What happens with the GUIDs in the cases where the user name is the same in both systems? How will it pick which one to keep?</a></p></li>
<li><p><a href="#what-about-accounts-that-arent-in-our-domain-a-lot-of-people-have-used-gmail-yahoo-and-a-lot-of-others-for-the-key">What about accounts that aren’t in our domain? A lot of people have used gmail, yahoo and a lot of others for the Key.</a></p></li>
<li><p><a href="#but-lets-say-the-key-user-name-and-the-relay-user-names-arent-only-different-in-the-domain-part-of-the-address-what-if-i-had-john4325yahoocom-for-the-key-and-johndoecruorg-for-relay-will-there-be-a-manual-process-to-reconcile-those">But let’s say the key user name and the relay user names aren’t only different in the domain part of the address. What if I had john4325@yahoo.com for the Key and john.doe@cru.org for Relay? Will there be a manual process to reconcile those?</a></p></li>
<li><p><a href="#can-i-specify-that-all-users-of-my-domain-eg-agapefranceorg-keep-their-the-key-usernamepassword-regardless-of-other-logic">Can I specify that all users of my domain (e.g. @agapefrance.org) keep their Key username regardless of other logic?</a></p></li>
<li><p><a href="#is-there-any-impact-on-the-people-who-log-into-the-key-using-facebook">Is there any impact on the people who log into the key using facebook?</a></p></li>
<li><p><a href="#">Relay imposes password constraints that Key does not. How will this be handled?</a></p></li>
</ul>

<hr>

<h4 id="what-is-the-merge-logic">What is the merge logic?</h4>

<p><a href="https://docs.google.com/drawings/d/1fPTKAJyRuVFW4FuYWej3lItIDOrvxnuU1YuodREIsGQ/edit?usp=sharing">Have a look at this flow chart</a></p>

<p>We are using the Key database as the starting point, and adding all the Relay accounts to it, dealing with matches/conflicts along the way using the logic in that flow chart. </p>

<p>The total number of affected accounts is relatively small (~10% of key users). The majority of those affected are US staff (serving in the US or other countries) being forced to use their @cru.org domain name (or other US google domain) for their key login. The reason for this is purely technical. The Google Apps for US provisions accounts (and password changes) via Relay. This is the reason US staff were required to use their @cru.org account for Relay. After the merge, relay and key usernames will be the same for those staff, meaning their Key login needs to be a US google domain. Most US staff didn’t change their Key usernames when their Relay usernames changes, so changing those accounts for most of the Key -&gt; Relay username changes.</p>

<p>Below is a <strong>snapshot</strong> of the numbers of users in various scenarios. The actual numbers change on a daily basis based on usage of the 2 systems, but this will give you a rough idea. </p>

<p>310K Relay accounts (approximate) <br>
45,813 Relay accounts match or conflict with existing Key accounts</p>

<p><strong>Usernames</strong> <br>
39,618  Relay and Key usernames match (no change needed if passwords match) <br>
425       Relay usernames changed to Key username. <br>
5,073    Key usernames changed to Relay username (this is mostly US staff).</p>

<p><strong>Passwords</strong> <br>
34,397  Relay and Key passwords match (no change needed if username matches) <br>
2,879    Relay passwords changed to Key password (this overlaps the 425 above). <br>
7,840    Key passwords changed to Relay password (this overlaps the 5,073 above).</p>

<p>~265K Relay accounts to be created in the Key.</p>

<hr>

<h4 id="which-users-will-be-affected">Which users will be affected?</h4>

<p>We have a snapshot of the affected users as of Oct 21st, 2015: <a href="https://docs.google.com/a/cru.org/spreadsheets/d/1z0NC3QzRmyhHqUkuKpD05XyBIk-Uzan_yhUW7OaLMDA/edit?usp=sharing">https://docs.google.com/a/cru.org/spreadsheets/d/1z0NC3QzRmyhHqUkuKpD05XyBIk-Uzan_yhUW7OaLMDA/edit?usp=sharing</a></p>

<p>That document has been shared with GTL so you can “spot check” some individual accounts and get a better idea of what will, but please don’t share it with others as it contains private email accounts. </p>

<p>That sheet only contains accounts that match or conflict between Key and Relay, and for most of those you can see nothing will change. There are hundreds of thousands of other accounts that are completely unaffected. If you search for an email address and it’s not on that sheet, that means it’s not going to be ‘linked’ after the merge.</p>

<hr>

<h4 id="what-can-i-do-ahead-of-time-to-prepare">What can I do ahead of time to prepare?</h4>

<p>If you feel like it (not required), you can go in ahead of time and make sure that your username/password on the two systems are the same. If you do that, you won’t experience any change on the day of the merge. This isn’t something we’re asking people to do, but you’re certainly welcome to do so. <em>Caveat: If your relay username is a US domain set up in Google Apps that gets provisioned via Relay, you won’t be allowed to change it.</em></p>

<hr>

<h4 id="are-there-constraints-on-us-about-which-email-is-allowed-as-a-relay-username">Are there constraints on us about which email is allowed as a Relay username?</h4>

<p>Yes. In an effort to keep things simple for staff, a decision was made when Google Apps was deployed in the US to use Relay to provision Google Accounts. For US staff, changing your Relay password changes your Google Account password. In order for this to work properly, it was necessary to add a constraint that Relay usernames must match the primary email address in Google for US staff. The most common implication of this is that US staff are required to use a @cru.org email address in Relay instead of one of the domain aliases (@uscm.org, @ccci.org, etc). Exceptions have been made for some users/domains based on requirements of secure locations. </p>

<hr>

<h4 id="are-we-merging-into-the-key-or-into-relay-or-is-the-end-result-something-different-1">Are we merging into the Key or into Relay? Or is the end result something different?</h4>

<p>Relay data is being added to the Key database (ldap). We’re unifying the database that stores the usernames and passwords so that Key and Relay credentials will always be the same. Key and Relay login screens will both continue to exist. The only implication is that <strong>if your accounts matched</strong> your username and password in both systems will become the same thing, and changing your username/password in one system will change it in the other. </p>

<hr>

<h4 id="either-way-will-i-still-have-admin-access-afterwards-1">Either way will I still have admin access afterwards?</h4>

<p>If you had admin access before, you’ll still have it after. The Key and all of it’s admin tools will continue to exist and operate as they have. </p>

<hr>

<h4 id="do-we-need-to-do-anything-with-our-sites-weve-set-up-using-various-cas-plugins-to-authenticate-against-the-key">Do we need to do anything with our sites we’ve set up using various CAS plugins to authenticate against the Key?</h4>

<p>No. Nothing is changing with how sites integrate with The Key.</p>

<hr>



<h4 id="is-there-anything-youll-need-us-to-do">Is there anything you’ll need us to do?</h4>

<p>There’s nothing you need to do beyond being aware of the unification of credentials and helping communicate/educate those around you.</p>

<hr>



<h4 id="what-does-that-mean-in-terms-of-single-sign-on-will-things-still-be-separate-then-if-say-i-were-logged-into-the-us-staff-web-and-then-opened-gma-in-another-tab-or-would-gma-think-i-was-already-logged-in-with-my-relay-account">What does that mean in terms of single sign on? Will things still be separate then if say I were logged into the US staff web and then opened GMA in another tab? Or would GMA think I was already logged in with my relay account?</h4>

<p>There will be “same sign on” between relay and key sites. Meaning it’ll behave the same way it does now (not detect that you’re already logged in). </p>

<hr>



<h4 id="if-so-will-there-be-a-way-for-users-to-merge-key-accounts-and-relay-accounts-that-have-different-use-names">If so will there be a way for users to merge key accounts and relay accounts that have different use names?</h4>

<p>This will be happening automatically in some cases. <a href="https://docs.google.com/drawings/d/1fPTKAJyRuVFW4FuYWej3lItIDOrvxnuU1YuodREIsGQ/edit?usp=sharing">Have a look at this flow chart.</a> If the accounts don’t get merged automatically, you’ll end up with 2 (or more) accounts that both work in Relay and Key.</p>

<hr>



<h4 id="if-the-two-products-are-going-to-use-a-single-database-that-is-joining-all-the-records-together-does-that-mean-every-account-in-the-key-without-a-corresponding-relay-record-will-become-a-relay-account-and-vice-versa">If the two products are going to use a single database that is joining all the records together - does that mean every account in the key without a corresponding relay record will become a relay account and vice versa?</h4>

<p>Yes</p>

<hr>



<h4 id="what-happens-with-the-guids-in-the-cases-where-the-user-name-is-the-same-in-both-systems-how-will-it-pick-which-one-to-keep">What happens with the GUIDs in the cases where the user name is the same in both systems? How will it pick which one to keep?</h4>

<p>The system will keep track of both guids and hand back the correct guid based on which login page was used. So sites using the Key login will continue to get back a key guid. Sites using relay will continue to get back a relay guid. For any new accounts created after the merge (or before the original split), it’ll be the same guid.</p>

<hr>



<h4 id="am-i-right-in-assuming-that-my-key-password-will-then-be-my-relay-password-as-well">Am I right in assuming that my Key password will then be my Relay password as well?</h4>

<p>Yes </p>

<hr>



<h4 id="what-about-accounts-that-arent-in-our-domain-a-lot-of-people-have-used-gmail-yahoo-and-a-lot-of-others-for-the-key">What about accounts that aren’t in our domain? A lot of people have used gmail, yahoo and a lot of others for the Key.</h4>

<p>This isn’t a problem. Accounts from any domain will continue to work fine.</p>

<hr>



<h4 id="but-lets-say-the-key-user-name-and-the-relay-user-names-arent-only-different-in-the-domain-part-of-the-address-what-if-i-had-john4325yahoocom-for-the-key-and-johndoecruorg-for-relay-will-there-be-a-manual-process-to-reconcile-those">But let’s say the key user name and the relay user names aren’t only different in the domain part of the address. What if I had john4325@yahoo.com for the Key and john.doe@cru.org for Relay? Will there be a manual process to reconcile those?</h4>

<p>In that example, after the merge, you’ll still have 2 accounts. This merge process isn’t going to address merging people who have 2 Key accounts, or 2 Relay accounts, or do anything magical. So it’ll only ‘sync’/merge your key/relay accounts if we have some way of knowing for sure that that key login and that relay login are the same person. So, that includes: 1) all accounts created before the split (even if your usernames are now different), 2) accounts where the username is the same in both systems (only the password will change), 3) accounts where a user has done something to explicitly link the 2 accounts (this is a very small number of people).  </p>

<hr>



<h4 id="can-i-specify-that-all-users-of-my-domain-eg-agapefranceorg-keep-their-the-key-usernamepassword-regardless-of-other-logic">Can I specify that all users of my domain (e.g. @agapefrance.org) keep their The Key username/password regardless of other logic?</h4>

<p>Yes! Send an email to Josh with your domain name and we’ll ensure that all users on that domain name keep their Key credentials.</p>

<hr>



<h4 id="is-there-any-impact-on-the-people-who-log-into-the-key-using-facebook">Is there any impact on the people who log into the key using facebook?</h4>

<p>No.</p>

<hr>

<h4 id="relay-imposes-password-constraints-that-key-does-not-how-will-this-be-handled">Relay imposes password constraints that Key does not. How will this be handled?</h4>

<p>The Key will respect the 90 day password expiration rule that Relay currently has in place for users with access to the US HR system (that’s a very small percentage of users). If you are US staff, changing your Key password will change your google password as well (same as changing your Relay password).</p>

<p>Complexity requirements will not be validated during the merge, meaning if the merge picks your Key password, it’ll stay what it is even if it doesn’t meat Relay complexity requirements. If you change it in the future, each system will continue to have the same rules it does now. This means that you can change your password via the Key and potentially have a password that Relay would not have let you create. That’s fine. </p>

<hr></div></body>
</html>

